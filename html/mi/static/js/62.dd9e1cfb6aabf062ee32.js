webpackJsonp([62,77],{BxEw:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Dd8w"),s=i.n(n),a=i("NYxO");t.default={props:{containerClass:{type:String,default:""},permissions:{type:Array,default:function(){return[]}}},name:"crp_permission",data:function(){return{listLoading:!0,detailLoading:!0,tableKey:0}},computed:s()({},i.i(a.a)(["crpPermissions"])),created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetAllPermissions").then(function(){e.listLoading=!1},function(){})},handleFilter:function(){this.getList()},handleDelRelation:function(e){var t=this;t.$store.dispatch("DelPermissions").then(function(){t.temp.permissionList.splice(t.temp.permissionList.indexOf(e),1)})},check:function(e){this.$emit("check",e)},cancelCheck:function(e){this.$emit("cancel-check",e)},has:function(e){return this.permissions.some(function(t){return t.code===e})}}}},MhD1:function(e,t,i){var n=i("VU/8")(i("uq7Z"),i("e5Cf"),null,null,null);e.exports=n.exports},RpGP:function(e,t,i){var n=i("VU/8")(i("BxEw"),i("nUWv"),null,null,null);e.exports=n.exports},e5Cf:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,size:"full"}},[i("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{width:"900px","margin-left":"50px"},attrs:{model:e.detail,rules:e.detailRules,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{model:{value:e.detail.name,callback:function(t){e.detail.name=t},expression:"detail.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.detail.description,callback:function(t){e.detail.description=t},expression:"detail.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"关联权限"}},[0===e.detail.permissionList.length?i("span",[e._v("无关联角色")]):e._l(e.detail.permissionList,function(t){return i("el-tooltip",{key:t.id,attrs:{content:t.description,placement:"top"}},[i("el-tag",{attrs:{type:"success",closable:"create"==e.dialogStatus||e.checkPermission(e.permissionConstant.role_u)&&"update"===e.dialogStatus,"close-transition":!1},on:{close:function(i){e.handleDelRelation(t)}}},[e._v("\n          "+e._s(t.name)+"\n        ")])],1)})],2),e._v(" "),"create"==e.dialogStatus||e.checkPermission(e.permissionConstant.role_u)&&"update"===e.dialogStatus?i("el-form-item",{attrs:{label:"选择关联权限"}},[i("Permissions",{attrs:{permissions:e.detail.permissionList},on:{check:e.handleAddRelation,"cancel-check":e.handleDelRelation}})],1):e._e()],1),e._v(" "),i("div",{staticClass:"dialog-footer",slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.dialogStatus&&e.checkPermission(e.permissionConstant.role_u)?[i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])]:e._e()],2)],1)},staticRenderFns:[]}},nUWv:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.containerClass]},[i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.crpPermissions.records,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{width:"110",align:"center",label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"110",align:"center",label:"权限编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.code))])]}}])}),e._v(" "),i("el-table-column",{attrs:{"min-width":"250px",align:"center",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.description))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.has(t.row.code)?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.cancelCheck(t.row)}}},[e._v("取消选中")]):i("el-button",{attrs:{size:"small"},on:{click:function(i){e.check(t.row)}}},[e._v("选中")])]}}])})],1)],1)},staticRenderFns:[]}},uq7Z:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("woOf"),s=i.n(n),a=i("//Fk"),l=i.n(a),o=i("RpGP"),r=i.n(o);t.default={components:{Permissions:r.a},props:{dialogStatus:{type:String,default:"create"},dialogFormVisible:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{id:"",name:"",description:"",permissionList:[],permissionListStr:""}}}},data:function(){return{isMain:!1,textMap:{update:"编辑",create:"创建"},detailRules:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"},{min:3,max:10,message:"角色名称长度3到10位",trigger:"blur"}]}}},methods:{validate:function(){var e=this;return new l.a(function(t,i){e.$refs.detailForm.validate(function(e){e?t():i()})})},filterData:function(e){return e.permissionListStr=e.permissionList.map(function(e){return e.code}).join(","),delete e.permissionList,e},create:function(){var e=this,t=this;t.validate().then(function(){var i=s()({},t.detail);delete i.id,i=t.filterData(i),t.$store.dispatch("CreateRole",i).then(function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},update:function(){var e=this,t=this;t.validate().then(function(){var i=s()({},t.detail);i=t.filterData(i),t.$store.dispatch("UpdateRoleDetail",i).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},cancel:function(){this.$emit("cancel")},handleDelRelation:function(e){var t=e.code;this.detail.permissionList=this.detail.permissionList.filter(function(e){return e.code!==t})},handleAddRelation:function(e){this.detail.permissionList.push(e)}},watch:{dialogFormVisible:function(){this.$refs.detailForm&&this.$refs.detailForm.resetFields()}}}}});