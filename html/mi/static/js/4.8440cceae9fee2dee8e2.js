webpackJsonp([4,7,12,32,40,44,58,77],{"+hPY":function(e,t,i){t=e.exports=i("FZ+f")(!1),t.push([e.i,".fade-enter-active[data-v-64e24a1c],.fade-leave-active[data-v-64e24a1c]{-webkit-transition:opacity .5s;transition:opacity .5s}.fade-enter[data-v-64e24a1c],.fade-leave-to[data-v-64e24a1c]{opacity:0}.__upload__[data-v-64e24a1c]{display:inline-block;position:relative;cursor:pointer;border-radius:inherit}.__upload__>[type=file][data-v-64e24a1c]{position:absolute;left:0;top:0;bottom:0;right:0;width:100%;height:100%;opacity:0}.__queue__[data-v-64e24a1c]{width:400px;position:relative}.__item__[data-v-64e24a1c]{position:relative;line-height:30px;height:30px;margin:10px 0;background:#efefef;border-radius:2px;overflow:hidden}.__item__>div[data-v-64e24a1c]{position:absolute;font-size:12px;height:30px}.__name__[data-v-64e24a1c]{z-index:1;left:10px;color:#138d92;right:50px;text-overflow:ellipsis;overflow:hidden}.__name__>svg[data-v-64e24a1c]{display:inline-block;width:12px;height:12px;fill:currentColor;vertical-align:middle;-webkit-transform:translateY(-2px);transform:translateY(-2px)}.__progress__[data-v-64e24a1c]{left:0;top:0;bottom:0;background:#d9eaea;z-index:0}.__percent__[data-v-64e24a1c]{right:50px;top:0;width:40px;height:30px;text-align:center;font-size:10px;color:#138d92}.__cancel__[data-v-64e24a1c]{right:0;top:0;width:30px;height:30px;text-align:center;color:#fff}.__cancel__>svg[data-v-64e24a1c]{width:14px;height:14px;fill:red;-webkit-transform:translateY(4px);transform:translateY(4px)}.__success__[data-v-64e24a1c]{right:0;top:0;width:20px;color:#138d92;-webkit-transform:translateY(2px);transform:translateY(2px)}.__success__>svg[data-v-64e24a1c]{width:12px;height:12px;fill:currentColor}",""])},"1o1S":function(e,t,i){var a=i("VU/8")(i("w8w0"),i("uOSp"),null,null,null);e.exports=a.exports},"36K8":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.dialogFormVisible?i("div",{staticClass:"modal"}):e._e(),e._v(" "),i("el-dialog",{attrs:{modal:!1,title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,size:"create"===e.dialogStatus?"full":"small"}},[i("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{margin:"0 50px"},attrs:{model:e.detail,rules:e.detailRules,"label-position":"left","label-width":"100px"}},["update"===e.dialogStatus?i("el-form-item",{attrs:{label:"关联用户"}},[i("span",{staticClass:"link-type",on:{click:function(t){e.toggleUser(!0)}}},[e._v(e._s(e.detail.user.mobile))])]):e._e(),e._v(" "),e.checkPermission(e.permissionConstant.present_u)&&"create"===e.dialogStatus?[i("el-form-item",{attrs:{label:"关联用户",prop:"mobile"}},[i("span",[e._v(e._s(e.detail.user.mobile))])]),e._v(" "),i("el-form-item",{attrs:{label:"选择关联用户"}},[i("Register-Record",{attrs:{"is-main":e.isMain,registers:""===e.detail.user.id?[]:[{id:e.detail.user.id}]},on:{check:e.handleAddUser,"cancel-check":e.handleDelUser}})],1)]:e._e(),e._v(" "),"update"===e.dialogStatus?i("el-form-item",{attrs:{label:"礼品"}},[i("span",{staticClass:"link-type",on:{click:function(t){e.togglePresent(!0)}}},[e._v(e._s(e.detail.present.name))])]):e._e(),e._v(" "),e.checkPermission(e.permissionConstant.present_u)&&"create"===e.dialogStatus?[i("el-form-item",{attrs:{label:"关联礼品",prop:"presentName"}},[i("span",[e._v(e._s(e.detail.present.name))])]),e._v(" "),i("el-form-item",{attrs:{label:"选择关联礼品"}},[i("Present-Record",{attrs:{"is-main":e.isMain,presents:""===e.detail.present.id?[]:[{id:e.detail.present.id}]},on:{check:e.handleAddPresent,"cancel-check":e.handleDelPresent}})],1)]:e._e(),e._v(" "),i("el-form-item",{attrs:{label:"编码"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.detail.presentOrder.number,callback:function(t){e.detail.presentOrder.number=t},expression:"detail.presentOrder.number"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态"},model:{value:e.detail.presentOrder.status,callback:function(t){e.detail.presentOrder.status=t},expression:"detail.presentOrder.status"}},e._l(e.statusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}))],1)],2),e._v(" "),i("div",{staticClass:"dialog-footer",slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.dialogStatus&&e.checkPermission(e.permissionConstant.presentOrder_u)?[i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])]:e._e()],2),e._v(" "),i("Register-Detail",{attrs:{title:"浏览","before-close":e.toggleUser,"dialog-status":"info",detail:e.detail.user,"dialog-form-visible":e.userVisible},on:{cancel:e.toggleUser}}),e._v(" "),i("Present-Detail",{attrs:{title:"浏览","before-close":e.togglePresent,"dialog-status":"info",detail:e.detail.present,"dialog-form-visible":e.presentVisible},on:{cancel:e.togglePresent}})],1)],1)},staticRenderFns:[]}},"3hAG":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.dialogFormVisible?i("div",{staticClass:"modal",staticStyle:{"z-index":"1200"}}):e._e(),e._v(" "),i("el-dialog",{attrs:{modal:!1,title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,size:"small"}},[i("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{width:"320px","margin-left":"50px"},attrs:{model:e.detail,rules:e.detailRules,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"礼品名称",prop:"name"}},[i("el-input",{model:{value:e.detail.name,callback:function(t){e.detail.name=t},expression:"detail.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"图片"}},["create"==e.dialogStatus||e.checkPermission(e.permissionConstant.present_u)&&"update"===e.dialogStatus?[i("upload",{attrs:{action:e.image.action,headers:e.uploadHeaders(),disabled:e.image.loading},on:{change:e.image.change,success:e.uploadSuccess,error:e.uploadError}},[i("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",loading:e.image.loading}},[e._v("上传缩略图")])],1)]:e._e(),e._v(" "),i("img",{staticStyle:{width:"200px",height:"auto",border:"1px solid #bfcbd9"},attrs:{src:e.detail.image,alt:""}})],2),e._v(" "),i("el-form-item",{attrs:{label:"地址",prop:"priority"}},[i("el-input",{model:{value:e.detail.address,callback:function(t){e.detail.address=t},expression:"detail.address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"权重",prop:"weight"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.detail.weight,callback:function(t){e.detail.weight=t},expression:"detail.weight"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"需求",prop:"requirement"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.detail.requirement,callback:function(t){e.detail.requirement=t},expression:"detail.requirement"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"库存",prop:"stock"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.detail.stock,callback:function(t){e.detail.stock=t},expression:"detail.stock"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"有效时间"}},[i("el-date-picker",{attrs:{clearable:!1,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.detail.expiryDate,callback:function(t){e.detail.expiryDate=t},expression:"detail.expiryDate"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态"},model:{value:e.detail.hide,callback:function(t){e.detail.hide=t},expression:"detail.hide"}},e._l(e.statusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}))],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.dialogStatus&&e.checkPermission(e.permissionConstant.present_u)?[i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])]:e._e()],2)],1)],1)},staticRenderFns:[]}},"7oMk":function(e,t,i){var a=i("VU/8")(i("jMdz"),i("3hAG"),null,null,null);e.exports=a.exports},"9Rkr":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("Records",{attrs:{containerClass:"app-container"}})},staticRenderFns:[]}},BxEw:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),s=i("NYxO");t.default={props:{containerClass:{type:String,default:""},permissions:{type:Array,default:function(){return[]}}},name:"crp_permission",data:function(){return{listLoading:!0,detailLoading:!0,tableKey:0}},computed:n()({},i.i(s.a)(["crpPermissions"])),created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetAllPermissions").then(function(){e.listLoading=!1},function(){})},handleFilter:function(){this.getList()},handleDelRelation:function(e){var t=this;t.$store.dispatch("DelPermissions").then(function(){t.temp.permissionList.splice(t.temp.permissionList.indexOf(e),1)})},check:function(e){this.$emit("check",e)},cancelCheck:function(e){this.$emit("cancel-check",e)},has:function(e){return this.permissions.some(function(t){return t.code===e})}}}},CvQL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),s=i("//Fk"),r=i.n(s),l=i("RpGP"),o=i.n(l),c=i("E4LH");t.default={components:{Permissions:o.a},props:{dialogStatus:{type:String,default:"create"},statusOptions:{type:Array,default:function(){return[{label:"有效",key:"false"},{label:"冻结",key:"true"}]}},dialogFormVisible:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{id:"",name:"",mobile:"",locked:"false",presentChance:0,promotionalPartnerId:"",shared:!1}}}},data:function(){return{isMain:!1,textMap:{update:"编辑",create:"创建"},detailRules:{mobile:[{required:!0,validator:c.a,message:"手机号码不合法",trigger:"blur"}]}}},methods:{validate:function(){var e=this;return new r.a(function(t,i){e.$refs.detailForm.validate(function(e){e?t():i()})})},create:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail);delete i.id,t.$store.dispatch("CreateRegister",i).then(function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},update:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail);t.$store.dispatch("UpdateRegisterDetail",i).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},cancel:function(){this.$emit("cancel")}},watch:{dialogFormVisible:function(){this.$refs.detailForm&&this.$refs.detailForm.resetFields()}}}},DmoS:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"__upload__"},[e._t("default"),e._v(" "),i("input",{attrs:{type:"file",disabled:e.disabled,accept:e.accepts,multiple:e.multiple},on:{change:function(t){e.change(t)}}})],2),e._v(" "),e.queue&&e.safeFiles.length>0?i("div",{staticClass:"__queue__"},[i("transition-group",{attrs:{name:"fade",mode:"out-in"}},e._l(e.safeFiles,function(t,a){return t.done?e._e():i("div",{key:a,staticClass:"__item__"},[i("div",{staticClass:"__progress__",style:{width:t.progress+"%"}}),e._v(" "),i("div",{staticClass:"__name__"},[i("svg",{attrs:{viewBox:"0 0 1024 1024"}},[i("path",{attrs:{d:"M636.974339 66.552765 139.739625 66.552765l0 890.583384 742.153844 0L881.893468 304.049854 636.974339 66.552765 636.974339 66.552765zM591.950913 348.826664 591.950913 125.932154 822.506916 348.826664 591.950913 348.826664 591.950913 348.826664zM591.950913 348.826664"}})]),e._v("\n          "+e._s(t.name)+"\n        ")]),e._v(" "),t.progress>0&&t.progress<100?i("div",{staticClass:"__percent__"},[e._v(e._s(t.progress)+"%")]):e._e(),e._v(" "),t.progress<100?i("div",{staticClass:"__cancel__",on:{click:function(t){e.cancel(a)}}},[i("svg",{attrs:{viewBox:"0 0 1024 1024"}},[i("path",{attrs:{d:"M512.325411 0c-282.578844 0-511.653099 229.075279-511.653099 511.653099 0 282.578844 229.074256 511.653099 511.653099 511.653099s511.653099-229.074256 511.653099-511.653099C1023.978511 229.075279 794.904255 0 512.325411 0zM726.690664 761.454422c-4.821819 4.146437-10.754948 6.183839-16.663518 6.183839-7.194866 0-14.352893-3.022847-19.412119-8.906857L509.457084 548.069497 329.953827 760.043283c-5.059226 5.983271-12.272511 9.05626-19.535939 9.05626-5.838985 0-11.710716-1.986237-16.520255-6.058996-10.780531-9.131985-12.123109-25.269523-2.991124-36.051077l184.773284-218.201627L302.096363 306.936601c-9.212826-10.717086-7.995091-26.868951 2.716878-36.080753 10.711969-9.193383 26.881231-8.000208 36.080753 2.716878L509.160325 469.24729l166.813237-196.993606c9.118682-10.799974 25.296129-12.123109 36.051077-2.991124 10.79281 9.131985 12.130272 25.276686 2.998287 36.056194L542.939663 508.529969l186.472995 216.84984C738.619344 736.083591 737.40775 752.23648 726.690664 761.454422z",fill:"#e84122"}})])]):e._e(),e._v(" "),100==t.progress?i("div",{staticClass:"__success__"},[i("svg",{attrs:{viewBox:"0 0 1024 1024"}},[i("path",{attrs:{d:"M512 0C229.239467 0 0 229.239467 0 512s229.239467 512 512 512 512-229.239467 512-512S794.760533 0 512 0z m-68.778667 699.733333l-0.170666-0.136533-0.1536 0.136533L238.933333 490.376533l35.328-34.594133 168.789334 157.934933L752.298667 324.266667 785.066667 359.287467 443.221333 699.733333z"}})])]):e._e()])}))],1):e._e()])},staticRenderFns:[]}},E4LH:function(e,t,i){"use strict";function a(e){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)}function n(e,t,i){""===t||/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/.test(t)?i():i(new Error("手机号码不合法"))}function s(e){return function(t,i,a){i&&!/^[\d]+$/.test(i)?a(new Error(e)):a()}}function r(e){return function(t,i,a){i&&!/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/.test(i)?a(new Error(e)):a()}}function l(e,t,i){t>999?i("优先权重最大999"):i()}t.e=a,t.a=n,t.c=s,t.d=r,t.b=l},"Fb++":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.dialogFormVisible?i("div",{staticClass:"modal",staticStyle:{"z-index":"1200"}}):e._e(),e._v(" "),i("el-dialog",{attrs:{modal:!1,title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,size:"small"}},[i("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{width:"320px","margin-left":"50px"},attrs:{model:e.detail,rules:e.detailRules,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[i("el-input",{model:{value:e.detail.mobile,callback:function(t){e.detail.mobile=t},expression:"detail.mobile"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"抽奖次数"}},[i("el-input",{attrs:{type:"number",min:"0"},model:{value:e.detail.presentChance,callback:function(t){e.detail.presentChance=t},expression:"detail.presentChance"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"是否分享"}},[i("el-tooltip",{attrs:{content:e.detail.shared?"是":"否",placement:"top"}},[i("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949"},model:{value:e.detail.shared,callback:function(t){e.detail.shared=t},expression:"detail.shared"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态"},model:{value:e.detail.locked,callback:function(t){e.detail.locked=t},expression:"detail.locked"}},e._l(e.statusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}))],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.dialogStatus&&e.checkPermission(e.permissionConstant.role_u)?[i("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])]:e._e()],2)],1)],1)},staticRenderFns:[]}},IzBW:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),s=i("//Fk"),r=i.n(s),l=i("E4LH"),o=i("7oMk"),c=i.n(o),d=i("kjTw"),u=i.n(d),p=i("vVOB"),f=i.n(p),h=i("ddie"),m=i.n(h);t.default={components:{PresentDetail:c.a,RegisterDetail:f.a,PresentRecord:u.a,RegisterRecord:m.a},props:{dialogStatus:{type:String,default:"create"},statusOptions:{type:Array,default:function(){return[]}},dialogFormVisible:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{present:{id:"",name:"",image:"",address:"",stock:"",requirement:"",weight:0,expiryDate:"",hide:""},presentOrder:{id:"",presentId:"",userId:"",number:"",status:""}}}}},data:function(){return{userVisible:!1,presentVisible:!1,isMain:!1,textMap:{update:"编辑",create:"创建"},detailRules:{name:[{required:!0,min:3,max:32,message:"分类名称长度3到32位",trigger:"blur"}],priority:[{validator:l.b,trigger:"blur"},{validator:l.c("优先权重只能为数字"),trigger:"blur"}]}}},methods:{validate:function(){var e=this;return new r.a(function(t,i){e.$refs.detailForm.validate(function(e){e?t():i()})})},create:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail.presentOrder);delete i.id,i.userId=t.detail.user.id,i.presentId=t.detail.present.id,t.$store.dispatch("CreatePresentOrder",i).then(function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},update:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail.presentOrder);t.$store.dispatch("UpdatePresentOrderDetail",i).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},cancel:function(){this.$emit("cancel")},toggleUser:function(e){void 0===e&&(e=!1),this.userVisible=e},togglePresent:function(e){void 0===e&&(e=!1),this.presentVisible=e},handleDelUser:function(){this.detail.user.id="",this.detail.user.name=""},handleAddUser:function(e){var t=e.id,i=e.mobile;this.detail.user.id=t,this.detail.user.mobile=i},handleDelPresent:function(){this.detail.present.id="",this.detail.present.name=""},handleAddPresent:function(e){var t=e.id,i=e.name;this.detail.present.id=t,this.detail.present.name=i}},watch:{dialogFormVisible:function(){this.$refs.detailForm&&(this.$refs.detailForm.resetFields(),this.userVisible=!1,this.presentVisible=!1,this.detail.user.id="",this.detail.user.mobile="",this.detail.present.id="",this.detail.present.name="")}}}},K7IE:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),s=i("woOf"),r=i.n(s),l=i("NYxO"),o=i("7oMk"),c=i.n(o),d={address:"",expiryDate:"",hide:"",id:"",image:"",name:"",requirement:0,stock:0,weight:0};t.default={components:{PresentDetail:c.a},props:{containerClass:{type:String,default:""},isMain:{type:Boolean,default:!0},presents:{type:Array,default:function(){return[]}}},name:"crp_present",data:function(){return{selections:[],listLoading:!0,textMap:{update:"编辑",create:"创建"},listQuery:{targetPage:1,pageSize:10,keyword:void 0},temp:r()({},d),statusOptions:[{label:"显示",key:"false"},{label:"隐藏",key:"true"}],dialogFormVisible:!1,dialogStatus:"",tableKey:0}},computed:n()({},i.i(l.a)(["present"])),created:function(){this.getList()},filters:{statusFilter:function(e){return!1===e?"显示":"隐藏"}},methods:{getList:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetAllPresent",this.listQuery).then(function(){e.listLoading=!1},function(){})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.targetPage=e,this.getList()},handleBatchDelete:function(){if(0===this.selections.length)return void this.$message({message:"请选择要删除的奖品",type:"warning"});var e=this.selections.map(function(e){return e.id});this.delete(e,"确认批量删除奖品？")},handleModifyStatus:function(e){this.delete([e.id],"确认删除广告："+e.name+"？")},delete:function(e,t){var i=this;this.$confirm(t).then(function(){i.$store.dispatch("DelPresent",{ids:e}).then(function(){i.$message({message:"操作成功",type:"success"}),i.getList()})},function(){})},handleCreate:function(){this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(e){var t=this;this.$store.dispatch("GetPresentDetail",e.id).then(function(e){t.temp=r()({},e),t.temp.hide=String(t.temp.hide)}),this.dialogStatus="update",this.dialogFormVisible=!0},submit:function(){this.dialogFormVisible=!1,this.getList(),this.temp=r()({},d)},cancel:function(){this.dialogFormVisible=!1,this.temp=r()({},d)},check:function(e){this.$emit("check",e)},cancelCheck:function(e){this.$emit("cancel-check",e)},has:function(e){return this.presents.some(function(t){return t.id===e})},handleSelectionChange:function(e){this.selections=e}}}},RpGP:function(e,t,i){var a=i("VU/8")(i("BxEw"),i("nUWv"),null,null,null);e.exports=a.exports},TAej:function(e,t,i){function a(e){i("vB4V")}var n=i("VU/8")(i("jsWf"),i("DmoS"),a,"data-v-64e24a1c",null);e.exports=n.exports},"Wa+1":function(e,t,i){var a=i("VU/8")(i("mDi0"),i("9Rkr"),null,null,null);e.exports=a.exports},ZQnS:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),s=i("woOf"),r=i.n(s),l=i("NYxO"),o=i("vVOB"),c=i.n(o),d={id:"",name:"",mobile:"",locked:"false",presentChance:0,promotionalPartnerId:"",shared:!1};t.default={components:{RegisterDetail:c.a},props:{containerClass:{type:String,default:""},isMain:{type:Boolean,default:!0},registers:{type:Array,default:function(){return[]}}},name:"crp_register",data:function(){return{selections:[],listLoading:!0,textMap:{update:"编辑",create:"创建"},listQuery:{targetPage:1,pageSize:10,keyword:void 0},temp:r()({},d),statusOptions:[{label:"有效",key:"false"},{label:"冻结",key:"true"}],dialogFormVisible:!1,dialogStatus:"",tableKey:0}},computed:n()({},i.i(l.a)(["register"])),created:function(){this.getList()},filters:{statusFilter:function(e){return!1===e?"有效":"冻结"}},methods:{getList:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetAllRegister",this.listQuery).then(function(){e.listLoading=!1},function(){})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.targetPage=e,this.getList()},handleBatchDelete:function(){if(0===this.selections.length)return void this.$message({message:"请选择要删除的用户",type:"warning"});var e=this.selections.map(function(e){return e.id});this.delete(e,"确认批量删除用户？")},handleModifyStatus:function(e){this.delete([e.id],"确认删除用户："+e.name+"？")},delete:function(e,t){var i=this;this.$confirm(t).then(function(){i.$store.dispatch("DelRegister",{ids:e}).then(function(){i.$message({message:"操作成功",type:"success"}),i.getList()})},function(){})},handleCreate:function(){this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(e){var t=this;this.$store.dispatch("GetRegisterDetail",e.id).then(function(e){t.temp=r()({},e),t.temp.locked=String(t.temp.locked)}),this.dialogStatus="update",this.dialogFormVisible=!0},submit:function(){this.dialogFormVisible=!1,this.getList(),this.temp=r()({},d)},cancel:function(){this.dialogFormVisible=!1,this.temp=r()({},d)},check:function(e){this.$emit("check",e)},cancelCheck:function(e){this.$emit("cancel-check",e)},has:function(e){return this.registers.some(function(t){return t.id===e})},handleSelectionChange:function(e){this.selections=e}}}},cHx6:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.containerClass]},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"礼品名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.keyword,callback:function(t){e.listQuery.keyword=t},expression:"listQuery.keyword"}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),e.isMain?[e.checkPermission(e.permissionConstant.present_c)?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("添加")]):e._e(),e._v(" "),e.checkPermission(e.permissionConstant.present_d)?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"edit"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]):e._e()]:e._e()],2),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.present.records,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[e.isMain?i("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"名称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:{"link-type":e.isMain},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"160",align:"center",label:"图片"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{width:"120px",height:"auto","padding-top":"5px"},attrs:{src:e.row.image,alt:""}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.address))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"库存",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.stock))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"需求",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.requirement))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"抽奖权重",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.weight))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"有效时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.expiryDate))])]}}])}),e._v(" "),e.isMain?[i("el-table-column",{attrs:{"class-name":"status-col",label:"状态",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:t.row.hide?"danger":"primary"}},[e._v(e._s(e._f("statusFilter")(t.row.hide)))])]}}])}),e._v(" "),e.checkPermission(e.permissionConstant.present_d)?i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){e.handleModifyStatus(t.row,!0)}}},[e._v("删除")])]}}])}):e._e()]:[i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.has(t.row.id)?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.cancelCheck(t.row)}}},[e._v("取消选中")]):i("el-button",{attrs:{size:"small"},on:{click:function(i){e.check(t.row)}}},[e._v("选中")])]}}])})]],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.present.pageInfo.totalRow},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.listQuery.currentPage=t}}})],1),e._v(" "),i("Present-Detail",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,"dialog-status":e.dialogStatus,detail:e.temp,"status-options":e.statusOptions,"dialog-form-visible":e.dialogFormVisible},on:{submit:function(t){e.submit()},cancel:function(t){e.cancel()}}})],1)},staticRenderFns:[]}},ddie:function(e,t,i){var a=i("VU/8")(i("ZQnS"),i("lpkI"),null,null,null);e.exports=a.exports},jMdz:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),s=i("//Fk"),r=i.n(s),l=i("TAej"),o=i.n(l),c=i("oGH5"),d=i("E4LH");t.default={components:{Upload:o.a},mixins:[new c.a(function(e){1===e.status&&(this.detail.image=e.result),this.image.loading=!1},function(){this.image.loading=!1})],props:{dialogStatus:{type:String,default:"create"},statusOptions:{type:Array,default:function(){return[]}},dialogFormVisible:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{id:"",name:"",hide:"",image:"",address:"",expiryDate:"",requirement:0,stock:0,weight:0}}}},data:function(){var e=this;return{isMain:!1,image:{action:"http://djq.tunnel.qydev.com/mi/presentAction/uploadImage",loading:!1,change:function(){e.image.loading=!0}},textMap:{update:"编辑",create:"创建"},detailRules:{name:[{required:!0,min:3,max:32,message:"奖品名称长度3到32位",trigger:"blur"}],requirement:[{validator:d.c("需求只能为数字"),trigger:"blur"}],stock:[{validator:d.c("库存只能为数字"),trigger:"blur"}],weight:[{validator:d.c("权重只能为数字"),trigger:"blur"}]}}},methods:{validate:function(){var e=this;return new r.a(function(t,i){if(e.image.loading)return e.$message.warning("正在上传图片缩略图，请稍后提交"),void i();e.$refs.detailForm.validate(function(e){e?t():i()})})},create:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail);delete i.id,t.$store.dispatch("CreatePresent",i).then(function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},update:function(){var e=this,t=this;t.validate().then(function(){var i=n()({},t.detail);t.$store.dispatch("UpdatePresentDetail",i).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},cancel:function(){this.$emit("cancel")}},watch:{dialogFormVisible:function(){this.$refs.detailForm&&this.$refs.detailForm.resetFields()}}}},jsWf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{action:{type:String},disabled:{type:Boolean,default:!1},headers:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},dataType:{type:String,default:"json"},auto:{type:Boolean,default:!0},name:{type:String,default:"theFile"},limit:{type:Number,default:20},accepts:{type:Array,default:function(){return["image/jpeg","image/png"]}},multiple:{type:Boolean,default:!1},chunked:{type:Boolean,default:!1},queue:{type:Boolean,default:!1}},data:function(){return{files:[],safeFiles:[],unsafeFiles:[],input:null}},methods:{change:function(e){this.input=e.target,this.files=[],this.unsafeFiles=[],this.files=e.target.files||e.dataTransfer.files;for(var t,i=0;t=this.files[i];i++)void 0==this.limit?this.addFile(t):t.size<=1024*this.limit*1024?this.addFile(t):this.unsafeFiles.push(t);this.$emit("change",this.safeFiles),this.auto&&(this.upload(),this.safeFiles=[])},addFile:function(e){for(var t,i=!1,a=0;t=this.safeFiles[a];a++)e.name==t.name&&(i=!0);i||(e.progress=0,this.safeFiles.push(e))},upload:function(){var e=this;if(this.unsafeFiles.length>0)return this.$emit("error","limit",this.unsafeFiles),!1;if(0==this.safeFiles.length)return this.$emit("error","empty"),!1;if(void 0==this.action)return this.$emit("error","action"),!1;this.input.value="";for(var t,i=0;t=this.safeFiles[i];i++)!function(t){t.size>5242880&&e.chunked?e.uploadChunked(t):e.uploadNormal(t)}(t)},uploadNormal:function(e){var t=this;if(e.xhr=new XMLHttpRequest,e.xhr.upload){var i=new FormData;if(i.append(this.name,e),void 0!=this.data)for(var a in this.data)i.append(a,this.data[a]);if(e.xhr.upload.progress=function(i){e.progress=Math.floor(i.loaded/i.total*100),100==e.progress&&window.setTimeout(function(){e.done=!0,t.$forceUpdate()},1e3),t.$emit("progress",e.progress),t.$forceUpdate()},e.xhr.onreadystatechange=function(i){if(4==e.xhr.readyState)if(200==e.xhr.status){var a=e.xhr.responseText;"json"==t.dataType&&(a=JSON.parse(a)),t.$emit("success",a)}else t.$emit("error","server",t.file)},e.xhr.open("POST",this.action,!0),void 0!=this.headers)for(var n in this.headers)e.xhr.setRequestHeader(n,this.headers[n]);e.xhr.withCredentials=!1,e.xhr.send(i)}},uploadChunked:function(e){var t=this,i=Math.random().toString(36).substr(2),a=Math.ceil(e.size/1048576),n=0,s=0;!function r(){var l=1048576*n,o=l+1048576;if(e.xhr=new XMLHttpRequest,e.xhr.upload){var c=new FormData;if(c.append("chunked","true"),c.append("chunkedIndex",n),c.append("chunkedID",i),c.append("chunkedTotal",a),c.append("chunkedData",e.slice(l,o)),void 0!=t.data)for(var d in t.data)c.append(d,t.data[d]);if(e.xhr.upload.addEventListener("progress",function(i){s+=i.loaded,e.progress=Math.floor(s/e.size*100),100==e.progress&&window.setTimeout(function(){e.done=!0,t.$forceUpdate()},1e3),t.$emit("progress",e.progress),t.$forceUpdate()},!1),e.xhr.onreadystatechange=function(i){if(4==e.xhr.readyState)if(200==e.xhr.status){var s=e.xhr.responseText;"json"==t.dataType&&(s=JSON.parse(s)),n++,n<a&&r(),t.$emit("success",s)}else t.$emit("error","server",t.file)},e.xhr.open("POST",t.action,!0),void 0!=t.headers)for(var u in t.headers)e.xhr.setRequestHeader(u,t.headers[u]);e.xhr.withCredentials=!1,e.xhr.send(c)}}()},submit:function(){this.upload()},cancel:function(e){this.safeFiles[e].xhr&&this.safeFiles[e].xhr.abort(),this.safeFiles.splice(e,1),this.input.value=""}}}},kjTw:function(e,t,i){var a=i("VU/8")(i("K7IE"),i("cHx6"),null,null,null);e.exports=a.exports},lpkI:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.containerClass]},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"手机号码"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.keyword,callback:function(t){e.listQuery.keyword=t},expression:"listQuery.keyword"}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),e.isMain?[e.checkPermission(e.permissionConstant.admin_c)?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("添加")]):e._e(),e._v(" "),e.checkPermission(e.permissionConstant.admin_d)?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"edit"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]):e._e()]:e._e()],2),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.register.records,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[e.isMain?i("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"手机号码"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:{"link-type":e.isMain},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v(e._s(t.row.mobile))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"180",align:"center",label:"抽奖次数"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.presentChance))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"140",align:"center",label:"是否分享"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.shared?i("span",[e._v("是")]):i("span",[e._v("否")])]}}])}),e._v(" "),e.isMain?[i("el-table-column",{attrs:{"class-name":"status-col",label:"状态",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:t.row.locked?"danger":"primary"}},[e._v(e._s(e._f("statusFilter")(t.row.locked)))])]}}])}),e._v(" "),e.checkPermission(e.permissionConstant.admin_d)?i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){e.handleModifyStatus(t.row,!0)}}},[e._v("删除")])]}}])}):e._e()]:[i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.has(t.row.id)?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.cancelCheck(t.row)}}},[e._v("取消选中")]):i("el-button",{attrs:{size:"small"},on:{click:function(i){e.check(t.row)}}},[e._v("选中")])]}}])})]],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.register.pageInfo.totalRow},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.listQuery.currentPage=t}}})],1),e._v(" "),i("Register-Detail",{attrs:{title:e.textMap[e.dialogStatus],"before-close":e.cancel,"dialog-status":e.dialogStatus,detail:e.temp,"status-options":e.statusOptions,"dialog-form-visible":e.dialogFormVisible},on:{submit:function(t){e.submit()},cancel:function(t){e.cancel()}}})],1)},staticRenderFns:[]}},mDi0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("1o1S"),n=i.n(a);t.default={components:{Records:n.a}}},meJN:function(e,t,i){var a=i("VU/8")(i("IzBW"),i("36K8"),null,null,null);e.exports=a.exports},nUWv:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.containerClass]},[i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.crpPermissions.records,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{width:"110",align:"center",label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"110",align:"center",label:"权限编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.code))])]}}])}),e._v(" "),i("el-table-column",{attrs:{"min-width":"250px",align:"center",label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.description))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.has(t.row.code)?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.cancelCheck(t.row)}}},[e._v("取消选中")]):i("el-button",{attrs:{size:"small"},on:{click:function(i){e.check(t.row)}}},[e._v("选中")])]}}])})],1)],1)},staticRenderFns:[]}},oGH5:function(e,t,i){"use strict";var a=i("Zrlr"),n=i.n(a),s=function e(t,i){return n()(this,e),{methods:{uploadHeaders:function(){return{}},uploadSuccess:function(e){var i=this;2===e.status?i.$messageBox.confirm("你已被登出，可以取消继续留在该页面，或者重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){i.$store.dispatch("FedLogOut").then(function(){location.reload()})}):1!==e.status&&i.$message({message:e.message||e.msg,type:"error",duration:2e3}),t.call(i,e)},uploadError:function(e){var t=this;"limit"===e&&t.$message({message:"图片大小不能超过20M",type:"error"}),"empty"===e&&t.$message({message:"请选择图片",type:"warning"}),"server"===e&&t.$message({message:"服务器错误，请联系管理员处理",type:"error"}),i.call(t,e)}}}};t.a=s},uOSp:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.containerClass]},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"订单ID"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.keyword,callback:function(t){e.listQuery.keyword=t},expression:"listQuery.keyword"}}),e._v(" "),e.isMain?i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"状态"},on:{change:e.handleFilter},model:{value:e.listQuery.status,callback:function(t){e.listQuery.status=t},expression:"listQuery.status"}},e._l(e.statusOptions,function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})):e._e(),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),e.isMain?[e.checkPermission(e.permissionConstant.presentOrder_d)?i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"edit"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]):e._e()]:e._e()],2),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.presentOrder.records,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[e.isMain?i("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"抽奖订单ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:{"link-type":e.isMain},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"礼品ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.presentId))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"用户ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.userId))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.number))])]}}])}),e._v(" "),e.isMain?[i("el-table-column",{attrs:{"class-name":"status-col",label:"状态",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:t.row.status?"danger":"primary"}},[e._v(e._s(e._f("statusFilter")(t.row.status)))])]}}])}),e._v(" "),e.checkPermission(e.permissionConstant.presentOrder_d)?i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){e.handleModifyStatus(t.row,!0)}}},[e._v("删除")])]}}])}):e._e()]:[i("el-table-column",{attrs:{align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.has(t.row.id)?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.cancelCheck(t.row)}}},[e._v("取消选中")]):i("el-button",{attrs:{size:"small"},on:{click:function(i){e.check(t.row)}}},[e._v("选中")])]}}])})]],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.currentPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.presentOrder.pageInfo.totalRow},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.listQuery.currentPage=t}}})],1),e._v(" "),i("PresentOrder-Detail",{attrs:{title:e.textMap[e.dialogStatus],"before-close":e.cancel,"dialog-status":e.dialogStatus,detail:e.temp,"status-options":e.statusOptions,"dialog-form-visible":e.dialogFormVisible},on:{submit:function(t){e.submit()},cancel:e.cancel}})],1)},staticRenderFns:[]}},vB4V:function(e,t,i){var a=i("+hPY");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("14bc98a0",a,!0)},vVOB:function(e,t,i){var a=i("VU/8")(i("CvQL"),i("Fb++"),null,null,null);e.exports=a.exports},w8w0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),s=i("woOf"),r=i.n(s),l=i("NYxO"),o=i("meJN"),c=i.n(o),d={present:{id:"",name:"",image:"",address:"",stock:"",requirement:"",weight:0,expiryDate:"",hide:""},presentOrder:{id:"",presentId:"",userId:"",number:"",status:"0"},user:{id:"",name:"",mobile:"",locked:"false",presentChance:0,promotionalPartnerId:"",shared:!1}};t.default={components:{PresentOrderDetail:c.a},props:{containerClass:{type:String,default:""},isMain:{type:Boolean,default:!0},presentOrders:{type:Array,default:function(){return[]}}},name:"crp_presentOrder",data:function(){return{selections:[],listLoading:!0,textMap:{update:"编辑",create:"创建"},listQuery:{targetPage:1,pageSize:10,keyword:void 0,status:"0"},temp:r()({},d),statusOptions:[{label:"待取",key:"0"},{label:"已取",key:"1"}],dialogFormVisible:!1,dialogStatus:"",tableKey:0}},computed:n()({},i.i(l.a)(["presentOrder"])),created:function(){this.getList()},filters:{statusFilter:function(e){return 0===e?"待取":"已取"}},methods:{getList:function(){var e=this;this.listLoading=!0,this.$store.dispatch("GetAllPresentOrder",this.listQuery).then(function(){e.listLoading=!1},function(){})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.targetPage=e,this.getList()},handleBatchDelete:function(){if(0===this.selections.length)return void this.$message({message:"请选择要删除的分类",type:"warning"});var e=this.selections.map(function(e){return e.id});this.delete(e,"确认批量删除抽奖订单？")},handleModifyStatus:function(e){this.delete([e.id],"确认删除订单："+e.id+"？")},delete:function(e,t){var i=this;this.$confirm(t).then(function(){i.$store.dispatch("DelPresentOrder",{ids:e}).then(function(){i.$message({message:"操作成功",type:"success"}),i.getList()})},function(){})},handleCreate:function(){this.temp=r()({},d),this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(e){var t=this;this.$store.dispatch("GetPresentOrderDetail",e.id).then(function(e){e.present.expiryDate=String(e.present.expiryDate),e.present.hide=String(e.present.hide),e.presentOrder.status=String(e.presentOrder.status),e.user.locked=String(e.user.locked),t.temp=r()({},e)}),this.dialogStatus="update",this.dialogFormVisible=!0},submit:function(){this.dialogFormVisible=!1,this.getList(),this.temp=r()({},d)},cancel:function(){this.dialogFormVisible=!1,this.temp=r()({},d)},check:function(e){this.$emit("check",e)},cancelCheck:function(e){this.$emit("cancel-check",e)},has:function(e){return this.presentOrders.some(function(t){return t.id===e})},handleSelectionChange:function(e){this.selections=e}}}}});