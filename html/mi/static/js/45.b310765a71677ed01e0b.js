webpackJsonp([45],{"+hPY":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".fade-enter-active[data-v-64e24a1c],.fade-leave-active[data-v-64e24a1c]{-webkit-transition:opacity .5s;transition:opacity .5s}.fade-enter[data-v-64e24a1c],.fade-leave-to[data-v-64e24a1c]{opacity:0}.__upload__[data-v-64e24a1c]{display:inline-block;position:relative;cursor:pointer;border-radius:inherit}.__upload__>[type=file][data-v-64e24a1c]{position:absolute;left:0;top:0;bottom:0;right:0;width:100%;height:100%;opacity:0}.__queue__[data-v-64e24a1c]{width:400px;position:relative}.__item__[data-v-64e24a1c]{position:relative;line-height:30px;height:30px;margin:10px 0;background:#efefef;border-radius:2px;overflow:hidden}.__item__>div[data-v-64e24a1c]{position:absolute;font-size:12px;height:30px}.__name__[data-v-64e24a1c]{z-index:1;left:10px;color:#138d92;right:50px;text-overflow:ellipsis;overflow:hidden}.__name__>svg[data-v-64e24a1c]{display:inline-block;width:12px;height:12px;fill:currentColor;vertical-align:middle;-webkit-transform:translateY(-2px);transform:translateY(-2px)}.__progress__[data-v-64e24a1c]{left:0;top:0;bottom:0;background:#d9eaea;z-index:0}.__percent__[data-v-64e24a1c]{right:50px;top:0;width:40px;height:30px;text-align:center;font-size:10px;color:#138d92}.__cancel__[data-v-64e24a1c]{right:0;top:0;width:30px;height:30px;text-align:center;color:#fff}.__cancel__>svg[data-v-64e24a1c]{width:14px;height:14px;fill:red;-webkit-transform:translateY(4px);transform:translateY(4px)}.__success__[data-v-64e24a1c]{right:0;top:0;width:20px;color:#138d92;-webkit-transform:translateY(2px);transform:translateY(2px)}.__success__>svg[data-v-64e24a1c]{width:12px;height:12px;fill:currentColor}",""])},DmoS:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"__upload__"},[e._t("default"),e._v(" "),a("input",{attrs:{type:"file",disabled:e.disabled,accept:e.accepts,multiple:e.multiple},on:{change:function(t){e.change(t)}}})],2),e._v(" "),e.queue&&e.safeFiles.length>0?a("div",{staticClass:"__queue__"},[a("transition-group",{attrs:{name:"fade",mode:"out-in"}},e._l(e.safeFiles,function(t,i){return t.done?e._e():a("div",{key:i,staticClass:"__item__"},[a("div",{staticClass:"__progress__",style:{width:t.progress+"%"}}),e._v(" "),a("div",{staticClass:"__name__"},[a("svg",{attrs:{viewBox:"0 0 1024 1024"}},[a("path",{attrs:{d:"M636.974339 66.552765 139.739625 66.552765l0 890.583384 742.153844 0L881.893468 304.049854 636.974339 66.552765 636.974339 66.552765zM591.950913 348.826664 591.950913 125.932154 822.506916 348.826664 591.950913 348.826664 591.950913 348.826664zM591.950913 348.826664"}})]),e._v("\n          "+e._s(t.name)+"\n        ")]),e._v(" "),t.progress>0&&t.progress<100?a("div",{staticClass:"__percent__"},[e._v(e._s(t.progress)+"%")]):e._e(),e._v(" "),t.progress<100?a("div",{staticClass:"__cancel__",on:{click:function(t){e.cancel(i)}}},[a("svg",{attrs:{viewBox:"0 0 1024 1024"}},[a("path",{attrs:{d:"M512.325411 0c-282.578844 0-511.653099 229.075279-511.653099 511.653099 0 282.578844 229.074256 511.653099 511.653099 511.653099s511.653099-229.074256 511.653099-511.653099C1023.978511 229.075279 794.904255 0 512.325411 0zM726.690664 761.454422c-4.821819 4.146437-10.754948 6.183839-16.663518 6.183839-7.194866 0-14.352893-3.022847-19.412119-8.906857L509.457084 548.069497 329.953827 760.043283c-5.059226 5.983271-12.272511 9.05626-19.535939 9.05626-5.838985 0-11.710716-1.986237-16.520255-6.058996-10.780531-9.131985-12.123109-25.269523-2.991124-36.051077l184.773284-218.201627L302.096363 306.936601c-9.212826-10.717086-7.995091-26.868951 2.716878-36.080753 10.711969-9.193383 26.881231-8.000208 36.080753 2.716878L509.160325 469.24729l166.813237-196.993606c9.118682-10.799974 25.296129-12.123109 36.051077-2.991124 10.79281 9.131985 12.130272 25.276686 2.998287 36.056194L542.939663 508.529969l186.472995 216.84984C738.619344 736.083591 737.40775 752.23648 726.690664 761.454422z",fill:"#e84122"}})])]):e._e(),e._v(" "),100==t.progress?a("div",{staticClass:"__success__"},[a("svg",{attrs:{viewBox:"0 0 1024 1024"}},[a("path",{attrs:{d:"M512 0C229.239467 0 0 229.239467 0 512s229.239467 512 512 512 512-229.239467 512-512S794.760533 0 512 0z m-68.778667 699.733333l-0.170666-0.136533-0.1536 0.136533L238.933333 490.376533l35.328-34.594133 168.789334 157.934933L752.298667 324.266667 785.066667 359.287467 443.221333 699.733333z"}})])]):e._e()])}))],1):e._e()])},staticRenderFns:[]}},E4LH:function(e,t,a){"use strict";function i(e){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(e)}function r(e,t,a){""===t||/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/.test(t)?a():a(new Error("手机号码不合法"))}function s(e){return function(t,a,i){a&&!/^[\d]+$/.test(a)?i(new Error(e)):i()}}function n(e){return function(t,a,i){a&&!/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/.test(a)?i(new Error(e)):i()}}function o(e,t,a){t>999?a("优先权重最大999"):a()}t.e=i,t.a=r,t.c=s,t.d=n,t.b=o},TAej:function(e,t,a){function i(e){a("vB4V")}var r=a("VU/8")(a("jsWf"),a("DmoS"),i,"data-v-64e24a1c",null);e.exports=r.exports},Xzzv:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.dialogFormVisible?a("div",{staticClass:"modal",staticStyle:{"z-index":"1200"}}):e._e(),e._v(" "),a("el-dialog",{attrs:{modal:!1,title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.cancel,size:"small"}},[a("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{width:"320px","margin-left":"50px"},attrs:{model:e.detail,rules:e.detailRules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"代金券名称",prop:"name"}},[a("el-input",{model:{value:e.detail.name,callback:function(t){e.detail.name=t},expression:"detail.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"缩略图"}},["create"==e.dialogStatus||e.checkPermission(e.permissionConstant.cashCoupon_u)&&"update"===e.dialogStatus?[a("upload",{attrs:{action:e.preImage.action,headers:e.uploadHeaders(),disabled:e.preImage.loading},on:{change:e.preImage.change,success:e.uploadSuccess,error:e.uploadError}},[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",loading:e.preImage.loading}},[e._v("上传缩略图")])],1)]:e._e(),e._v(" "),a("img",{staticStyle:{width:"200px",height:"auto",border:"1px solid #bfcbd9"},attrs:{src:e.detail.preImage,alt:""}})],2),e._v(" "),a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-input",{model:{value:e.detail.price,callback:function(t){e.detail.price=t},expression:"detail.price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"优惠金额",prop:"discountAmount"}},[a("el-input",{model:{value:e.detail.discountAmount,callback:function(t){e.detail.discountAmount=t},expression:"detail.discountAmount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"过期时间"}},[a("el-date-picker",{attrs:{clearable:!1,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.detail.expiryDate,callback:function(t){e.detail.expiryDate=t},expression:"detail.expiryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"优先权重",prop:"priority"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:e.detail.priority,callback:function(t){e.detail.priority=t},expression:"detail.priority"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否过期"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态"},model:{value:e.detail.expired,callback:function(t){e.detail.expired=t},expression:"detail.expired"}},e._l(e.expireOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态"},model:{value:e.detail.hide,callback:function(t){e.detail.hide=t},expression:"detail.hide"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),"create"==e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.dialogStatus&&e.checkPermission(e.permissionConstant.cashCoupon_u)?[a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])]:e._e()],2)],1)],1)},staticRenderFns:[]}},jsWf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{action:{type:String},disabled:{type:Boolean,default:!1},headers:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},dataType:{type:String,default:"json"},auto:{type:Boolean,default:!0},name:{type:String,default:"theFile"},limit:{type:Number,default:20},accepts:{type:Array,default:function(){return["image/jpeg","image/png"]}},multiple:{type:Boolean,default:!1},chunked:{type:Boolean,default:!1},queue:{type:Boolean,default:!1}},data:function(){return{files:[],safeFiles:[],unsafeFiles:[],input:null}},methods:{change:function(e){this.input=e.target,this.files=[],this.unsafeFiles=[],this.files=e.target.files||e.dataTransfer.files;for(var t,a=0;t=this.files[a];a++)void 0==this.limit?this.addFile(t):t.size<=1024*this.limit*1024?this.addFile(t):this.unsafeFiles.push(t);this.$emit("change",this.safeFiles),this.auto&&(this.upload(),this.safeFiles=[])},addFile:function(e){for(var t,a=!1,i=0;t=this.safeFiles[i];i++)e.name==t.name&&(a=!0);a||(e.progress=0,this.safeFiles.push(e))},upload:function(){var e=this;if(this.unsafeFiles.length>0)return this.$emit("error","limit",this.unsafeFiles),!1;if(0==this.safeFiles.length)return this.$emit("error","empty"),!1;if(void 0==this.action)return this.$emit("error","action"),!1;this.input.value="";for(var t,a=0;t=this.safeFiles[a];a++)!function(t){t.size>5242880&&e.chunked?e.uploadChunked(t):e.uploadNormal(t)}(t)},uploadNormal:function(e){var t=this;if(e.xhr=new XMLHttpRequest,e.xhr.upload){var a=new FormData;if(a.append(this.name,e),void 0!=this.data)for(var i in this.data)a.append(i,this.data[i]);if(e.xhr.upload.progress=function(a){e.progress=Math.floor(a.loaded/a.total*100),100==e.progress&&window.setTimeout(function(){e.done=!0,t.$forceUpdate()},1e3),t.$emit("progress",e.progress),t.$forceUpdate()},e.xhr.onreadystatechange=function(a){if(4==e.xhr.readyState)if(200==e.xhr.status){var i=e.xhr.responseText;"json"==t.dataType&&(i=JSON.parse(i)),t.$emit("success",i)}else t.$emit("error","server",t.file)},e.xhr.open("POST",this.action,!0),void 0!=this.headers)for(var r in this.headers)e.xhr.setRequestHeader(r,this.headers[r]);e.xhr.withCredentials=!1,e.xhr.send(a)}},uploadChunked:function(e){var t=this,a=Math.random().toString(36).substr(2),i=Math.ceil(e.size/1048576),r=0,s=0;!function n(){var o=1048576*r,l=o+1048576;if(e.xhr=new XMLHttpRequest,e.xhr.upload){var d=new FormData;if(d.append("chunked","true"),d.append("chunkedIndex",r),d.append("chunkedID",a),d.append("chunkedTotal",i),d.append("chunkedData",e.slice(o,l)),void 0!=t.data)for(var c in t.data)d.append(c,t.data[c]);if(e.xhr.upload.addEventListener("progress",function(a){s+=a.loaded,e.progress=Math.floor(s/e.size*100),100==e.progress&&window.setTimeout(function(){e.done=!0,t.$forceUpdate()},1e3),t.$emit("progress",e.progress),t.$forceUpdate()},!1),e.xhr.onreadystatechange=function(a){if(4==e.xhr.readyState)if(200==e.xhr.status){var s=e.xhr.responseText;"json"==t.dataType&&(s=JSON.parse(s)),r++,r<i&&n(),t.$emit("success",s)}else t.$emit("error","server",t.file)},e.xhr.open("POST",t.action,!0),void 0!=t.headers)for(var u in t.headers)e.xhr.setRequestHeader(u,t.headers[u]);e.xhr.withCredentials=!1,e.xhr.send(d)}}()},submit:function(){this.upload()},cancel:function(e){this.safeFiles[e].xhr&&this.safeFiles[e].xhr.abort(),this.safeFiles.splice(e,1),this.input.value=""}}}},oGH5:function(e,t,a){"use strict";var i=a("Zrlr"),r=a.n(i),s=function e(t,a){return r()(this,e),{methods:{uploadHeaders:function(){return{}},uploadSuccess:function(e){var a=this;2===e.status?a.$messageBox.confirm("你已被登出，可以取消继续留在该页面，或者重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){a.$store.dispatch("FedLogOut").then(function(){location.reload()})}):1!==e.status&&a.$message({message:e.message||e.msg,type:"error",duration:2e3}),t.call(a,e)},uploadError:function(e){var t=this;"limit"===e&&t.$message({message:"图片大小不能超过20M",type:"error"}),"empty"===e&&t.$message({message:"请选择图片",type:"warning"}),"server"===e&&t.$message({message:"服务器错误，请联系管理员处理",type:"error"}),a.call(t,e)}}}};t.a=s},vB4V:function(e,t,a){var i=a("+hPY");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("14bc98a0",i,!0)},wRwh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),r=a.n(i),s=a("//Fk"),n=a.n(s),o=a("TAej"),l=a.n(o),d=a("oGH5"),c=a("E4LH"),u=a("0xDb");t.default={components:{Upload:l.a},mixins:[new d.a(function(e){1===e.status&&(this.detail.preImage=e.result),this.preImage.loading=!1},function(){this.preImage.loading=!1})],props:{dialogStatus:{type:String,default:"create"},statusOptions:{type:Array,default:function(){return[]}},dialogFormVisible:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{id:"",shopId:"",name:"",preImage:"",price:0,discountAmount:0,expiryDate:"",expired:"false",hide:"false",priority:0}}}},data:function(){var e=this;return{expireOptions:[{label:"否",key:"false"},{label:"是",key:"true"}],preImage:{action:"http://djq.tunnel.qydev.com/mi/cashCouponAction/uploadImage",loading:!1,change:function(){e.preImage.loading=!0}},isMain:!1,showUpload:!1,textMap:{update:"编辑",create:"创建",info:"浏览"},detailRules:{name:[{required:!0,min:3,max:32,message:"代金券名称长度3到32位",trigger:"blur"}],priority:[{validator:c.b,trigger:"blur"},{validator:c.c("优先权重只能为数字"),trigger:"blur"}],price:[{validator:c.d("价格只能为数字"),trigger:"blur"}],discountAmount:[{validator:c.d("优惠金额只能为数字"),trigger:"blur"}],expireDate:[{require:!0,message:"过期时间不能为空",trigger:"blur"}]}}},methods:{validate:function(){var e=this,t=this;return new n.a(function(a,i){if(t.preImage.loading)return t.$message.warning("正在上传图片缩略图，请稍后提交"),void i();e.$refs.detailForm.validate(function(e){e?a():i()})})},create:function(){var e=this,t=this;t.validate().then(function(){var i=r()({},t.detail);delete i.id,i.expiryDate=a.i(u.c)(i.expiryDate),t.$store.dispatch("CreateCashCoupon",i).then(function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},update:function(){var e=this,t=this;t.validate().then(function(){var i=r()({},t.detail);i.expiryDate=a.i(u.c)(i.expiryDate),t.$store.dispatch("UpdateCashCouponDetail",i).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.$emit("submit")},function(){})},function(){})},cancel:function(){this.$emit("cancel")}},watch:{dialogFormVisible:function(){this.$refs.detailForm&&(this.$refs.detailForm.resetFields(),this.preImage.loading=!1)}}}},"yZ/3":function(e,t,a){var i=a("VU/8")(a("wRwh"),a("Xzzv"),null,null,null);e.exports=i.exports}});